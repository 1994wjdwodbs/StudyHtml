<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Interest</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel="stylesheet" href="css/init.css">
    <link rel="stylesheet" href="css/form.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/search.css">
    <link rel="stylesheet" href="css/designes.css">
    <link rel="stylesheet" href="css/section.css">
    <link rel="stylesheet" href="css/lightbox.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    
    <script src="js/jquery-3.5.1.min.js"></script>
    <script src="js/masonry.pkgd.min.js"></script>
    <script src="js/imagesloaded.pkgd.min.js"></script>
    <script src="js/jquery.autocomplete.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    
    <!-- 이미지 크기 표시 (집어넣어야함) -->
    <!-- 이미지 다운로드 () -->
    <!-- 흰 글자 박스 타입 png 만들기 () -->
    <!-- 파일 읽기 / 검색 박스, 검색 만들기 및 디자인 () -->
    <!-- html github 정리 -->
    
    <!-- html 예제(복붙) 및 연습문제 풀이 -->
    <!-- mssql 설치, 공부 -->
    <!-- 정처기, 컴활 빠른 학습 -->
    
    <script>
        // 전역 변수
        var files;
        var array, array2, array3;
        var init_flag = false;
        var interval = null;

        // 숫자 콤마 찍어주는 함수
        function comma(value) {
            var data = value + "";
            var arrResult = data.split(""); 
            var startIndex = arrResult.length - 3; 
            for (let i = startIndex; i > 0; i = i - 3) { 
                arrResult.splice(i, 0, ","); 
            } 
            return arrResult.join(''); 
        }

        $(document).ready(function() {
            var colors = new Array(
                [62,35,255], 
                [60,255,60],
                [255,35,98],
                [45,175,230],
                [255,0,255],
                [255,128,0]);

                var step = 0;
                //color table indices for: 

                // current color left
                // next color left
                // current color right
                // next color right
                var colorIndices = [0,1,2,3];

                //transition speed
                var gradientSpeed = 0.001;

                clearInterval(interval);

                function updateGradient() {
                    if(interval != null)
                        
                    if ( $===undefined ) return;
                    
                    if($("#gradient").height)

                    var c0_0 = colors[colorIndices[0]];
                    var c0_1 = colors[colorIndices[1]];
                    var c1_0 = colors[colorIndices[2]];
                    var c1_1 = colors[colorIndices[3]];

                    var istep = 1 - step;
                    var r1 = Math.round(istep * c0_0[0] + step * c0_1[0]);
                    var g1 = Math.round(istep * c0_0[1] + step * c0_1[1]);
                    var b1 = Math.round(istep * c0_0[2] + step * c0_1[2]);
                    var color1 = "rgb("+r1+","+g1+","+b1+")";

                    var r2 = Math.round(istep * c1_0[0] + step * c1_1[0]);
                    var g2 = Math.round(istep * c1_0[1] + step * c1_1[1]);
                    var b2 = Math.round(istep * c1_0[2] + step * c1_1[2]);
                    var color2 = "rgb("+r2+","+g2+","+b2+")";

                    $('#gradient').css({
                    background: "-webkit-gradient(linear, left top, right top, from("+color1+"), to("+color2+"))"}).css({
                        background: "-moz-linear-gradient(left, "+color1+" 0%, "+color2+" 100%)"});
                    
                    step += gradientSpeed;
                    if ( step >= 1 )
                    {
                        step %= 1; // 0 ~ 1 사이값
                        colorIndices[0] = colorIndices[1];
                        colorIndices[2] = colorIndices[3];
                        
                        //pick two new target color indices
                        //do not pick the same as the current one
                        colorIndices[1] = ( colorIndices[1] + Math.floor( 1 + Math.random() * (colors.length - 1))) % colors.length;
                        colorIndices[3] = ( colorIndices[3] + Math.floor( 1 + Math.random() * (colors.length - 1))) % colors.length;
                    }
                }

                interval = setInterval(updateGradient,10);
        });
        

        // 함수 (showLightBox(), hideLightBox())
        function showLightBox() {
            $("#lightbox").css("top", $(document).scrollTop());

            // 라이트박스 보여주는 애니메이션
            $("#darken-background").css({display:"block", "top":"0px"}).animate({
                width:$(document).width(),
                height:$(document).height()
            }, 500);
            // 라이트박스 설정
            
            // $("#darken-background").css("top", $(window).scrollTop());
            // 스크롤 방지
            // $("body").css("overflow", "hidden");
            
            // 랜덤 이미지 섞기
            /*
            $("#random-image").attr({
                src: function() {
                    var rnd_height = Math.floor(Math.random() * 100) + 600;
                    return "https://placekitten.com/600/" + rnd_height.toString();
                }
            })*/
        }
        function hideLightBox() {
            // 라이트박스 숨기는 애니메이션
            $("#darken-background").animate({
                height:"0%"
            }, 500);
            
            // 스크롤 정상 작동
            // $("body").css("overflow", "auto");
        }


        // 풀다운 메뉴 (풀다운 메뉴 적용)
        $(document).ready(function() { // 로드 이벤트
            $(".outer-menu").hover
            (function() {
                // $(".inner-menu").css("display", "block");
                // 마우스 이벤트가 발생한 특정 inner-menu 클래스 선택
                $(this).find(".inner-menu").css("display", "block");
                
            }, 
            function() {
                $(this).find(".inner-menu").css("display", "none");
            });
        });

        // 페이지 (그리드 레이아웃 적용)
        $(document).ready(function() {
            //이미지 로드 확인 후 Masonry 플러그인 적용
            // $("#main-section").imagesLoaded(function() {

            //         $("#main-section").masonry({
            //             itemSelector: ".paper",
            //             columnWidth: 230,
            //             isAnimated: true
            //         });
            // });
           
        });

        $(document).ready(function() {

            // 클릭 이벤트 
            $(".paper").click(function() {

                // 일부 보이기 (테스트)
                // var papers =$(".paper");
                // for(let i = 0; i < 10; i++)
                //     $(papers[i]).show();

                // $("#main-section").masonry({
                //     itemSelector: ".paper",
                //     columnWidth: 230,
                //     isAnimated: true
                // });

                // console.log($("#random-image").attr("src"));
                // console.log($(this).find(".himg").attr("src"));
                
                // 클릭한 사진으로 팝업
                $("#random-image").attr("src", $(this).find(".himg").attr("src").toString());
                // console.log("test~!!!");
                // console.log($(this).find(".paper-text").text() + ", next?");
                // $(".user-information-text > h3").html("TEST");
                //라이트박스 크기 조절
                $("#lightbox").attr("width", $(window).width()*(3/4));
                $("#lightbox").attr("height", $(window).height()*(3/4));
                // $("#rightbox").attr("width", ($(window).width() - $("#lightbox").attr("width")) / 2);

                // 라이트박스 내 이미지 크기 조절
                $("#random-image").css({
                    "width":$(window).width()/3,
                    "height":$(window).height()*(2/3)
                });
                
                showLightBox();
            });

            // 바깥 여백(검정색 배경) 클릭 이벤트
            $("#darken-background").click(function() {
                hideLightBox();
            });
            // 라이트박스 제거 이벤트 보조
            $("#lightbox").click(function (event) {
                //event.stopPropagation();
            });
        });
        
        // 프로젝트 개량 : 내 폴더 이미지 갤러리 (Jallery)
        
        $(document).ready(function() {

            // Check for the various File API support.
            // if (window.File && window.FileReader && window.FileList && window.Blob) {
            // Great success! All the File APIs are supported.
            // console.log("ok");
            // } else {
            // alert('The File APIs are not fully supported in this browser.');
            // }

            $("#file-select").click(function() { 
                
            });
            $("#file-select").change(function() {

                $("section").fadeOut(500);
                setTimeout(() => {
                $("section").fadeIn();
                var fileInput = $("#file-select");
                files = fileInput[0].files;
                
                // 전역변수 array 초기화(재사용)
                array = [];
                array2 = [];
                array3 = [];
                $("section").empty();

                for(let i = 0, j = 0; i < files.length; i++) {

                    // jpg, png, gif 파일만 받아넣기!
                    if(files[i].webkitRelativePath.includes("jpg") || 
                    files[i].webkitRelativePath.includes("png") || files[i].webkitRelativePath.includes("gif")) {
                        array[j] = files[i].webkitRelativePath;
                        array2[j] = files[i].name;
                        array3[j] = files[i].size;

                        if(array3[j] < 1024)
                            array3[j] = comma(array3[j]) + " Byte";
                        else if(array3[j] < 1024 * 1024)
                            array3[j] = comma(parseInt(array3[j]/1024)) + " KB";
                        else  // (array3[j] >= 1024 * 1024 )
                            array3[j] = comma(parseInt(array3[j]/(1024*1024))) + " MB";

                        // 입력받은 만큼 paper (div) 태그 만들기
                        $("<div class=\"paper\"><input class=\"img_path\" type=\"hidden\" value=\"" + array[j] + "\"><div class=\"paper-holder\"><a><img class=\"himg\" width=\"190\" ></a></div><div class=\"paper-content\"><a class=\"paper-link\" href=\"#\"><img src=\"http://placekitten.com/30/30\"></a><p class=\"paper-text\">Lorem, ipsum dolor sit amet consectetur adipisicing elit. Rem, sequi blanditiis quod aliquid maiores dicta explicabo doloribus iste reiciendis quaerat voluptate, aspernatur sint beatae delectus tempore quo est ipsum eos!</p></div></div>").appendTo("section");
                        $(".paper").css("visibility", "hidden");
                        console.log(array[j]);
                        j++;
                    }
                }
                
                
                // alert($('input.input-search').val());
                
                // 자동완성 기능
                console.log(array);
                $('input.input-search').autocomplete({source: array});
                
                // 새로 만든 div 요소의 이벤트 위임
                $(document).on("click", ".paper", function() {

                    $("#random-image").attr("src", $(this).find(".himg").attr("src").toString());
                    // console.log("/" + "DownloadImage(" + $(this).find(".img_path").val().toString() + ")");
                    $(".user-information-text > h3").html($(this).find(".paper-text").text());
                    $(".user-information-text > a").text("TEST");
                    // <a href="#" onclick="fnc();return false;">
                    // $(".user-information-text > a").attr("onclick","DownloadImage(" + $("#random-image") + ")");
                    // $(".user-information-text > a").attr("download", $(this).find(".paper-text").text().split(" ")[0]);
                    
                    //라이트박스 크기 조절
                    $("#lightbox").css({
                        "width":$(window).width()*(3/4),
                        "height":$(window).height()*(3/4)
                    });
                    
                    $("#leftbox").css("top", $(document).scrollTop());
                    $("#leftbox").css({"height":($(window).height()*(3/4))});
                    $("#rightbox").css("top", $(document).scrollTop());
                    $("#rightbox").css({"height":($(window).height()*(3/4))});

                    // console.log($("#lightbox").attr("width"));
                    // console.log($("#lightbox").attr("height"));

                    // 라이트박스 내 이미지 크기 조절
                    $("#random-image").css({
                        "width":$(window).width()*(3/4),
                        "height":$(window).height()*(3/4) - 10*2 -70
                    });
                    // console.log($(".user-information-image").height());
                    showLightBox();

                    var papers =$(".paper");
                
                for(let i = 0; i < $(".paper").length; i++) {
                    if($(this).get(0) == $(papers[i]).get(0)) {
                        console.log("Find : " + array2[i]);
                    }

                }
                });

                var papers =$(".paper");
                
                $("#main-section").imagesLoaded(function() {
                    $("section").fadeIn(1000);
                    if(init_flag) {
                        $("#main-section").masonry('destroy');
                        $("#main-section").removeData('masonry');
                    } init_flag = true;

                    for(let i = 0; i < $(".paper").length; i++) {
                        
                        $(papers[i]).find(".himg").attr("src", array[i]);
                        $(papers[i]).find(".paper-text").html(array2[i] + " <br>(" + array3[i] +")");
                        // $("user-information-text > h3").html(array2[i]);
                        
                        //var infor_p
                        // $(papers[i]).css("visibility","hidden");

                        var random_num;
                        for(let j = 0; j < $(".paper").length; j++) {
                            random_num = 200 + Math.floor(Math.random() * 101);
                            //$(himg[i]).attr("src", 
                            //"http://placekitten.com/190/" + random_num.toString());

                            var p_content =$(".paper-content");
                            var colorR = Math.floor((Math.random() * 256));
                            var colorG = Math.floor((Math.random() * 256));
                            var colorB = Math.floor((Math.random() * 256));   
                            $(p_content[j]).css("background-color", "rgb(" + colorR + "," + colorG + "," + colorB + ")");
                        } 
                        
                        // $(papers[i]).hide();
                        // $(papers[i]).show("slow");

                    }
                    // for(let i = 0; i < $(".paper").length; i++) {
                    //     $(papers[i]).show("normal");
                    // }

                // $("#main-section").masonry({
                //     itemSelector: ".paper",
                //     columnWidth: 230,
                //     isAnimated: true
                // }); 
                    setTimeout(function() {
                        $("#main-section").masonry({
                            itemSelector: ".paper",
                            columnWidth: 230,
                            isAnimated: true
                        });
                        $(".paper").css("visibility","visible");
                        $(".paper").hide();
                        $(".paper").show("slow");

                        var colors = new Array(
                        [62,35,255], 
                        [60,255,60],
                        [255,35,98],
                        [45,175,230],
                        [255,0,255],
                        [255,128,0]);

                        var step = 0;
                        //color table indices for: 

                        // current color left
                        // next color left
                        // current color right
                        // next color right
                        var colorIndices = [0,1,2,3];

                        //transition speed
                        var gradientSpeed = 0.001;

                        clearInterval(interval);

                        function updateGradient() {
                            if(interval != null)
                                
                            if ( $===undefined ) return;
                            
                            if($("#gradient").height)

                            var c0_0 = colors[colorIndices[0]];
                            var c0_1 = colors[colorIndices[1]];
                            var c1_0 = colors[colorIndices[2]];
                            var c1_1 = colors[colorIndices[3]];

                            var istep = 1 - step;
                            var r1 = Math.round(istep * c0_0[0] + step * c0_1[0]);
                            var g1 = Math.round(istep * c0_0[1] + step * c0_1[1]);
                            var b1 = Math.round(istep * c0_0[2] + step * c0_1[2]);
                            var color1 = "rgb("+r1+","+g1+","+b1+")";

                            var r2 = Math.round(istep * c1_0[0] + step * c1_1[0]);
                            var g2 = Math.round(istep * c1_0[1] + step * c1_1[1]);
                            var b2 = Math.round(istep * c1_0[2] + step * c1_1[2]);
                            var color2 = "rgb("+r2+","+g2+","+b2+")";

                            $('#gradient').css({
                            background: "-webkit-gradient(linear, left top, right top, from("+color1+"), to("+color2+"))"}).css({
                                background: "-moz-linear-gradient(left, "+color1+" 0%, "+color2+" 100%)"});
                            
                            step += gradientSpeed;
                            if ( step >= 1 )
                            {
                                step %= 1; // 0 ~ 1 사이값
                                colorIndices[0] = colorIndices[1];
                                colorIndices[2] = colorIndices[3];
                                
                                //pick two new target color indices
                                //do not pick the same as the current one
                                colorIndices[1] = ( colorIndices[1] + Math.floor( 1 + Math.random() * (colors.length - 1))) % colors.length;
                                colorIndices[3] = ( colorIndices[3] + Math.floor( 1 + Math.random() * (colors.length - 1))) % colors.length;
                            }
                        }

                        interval = setInterval(updateGradient,10);
                    }, (array.length * 50)); // masonry는 시간이 걸리기 때문에, 사진 당 50ms 씩 딜레이를 줌

                });
                }, 500);
            });

        });

        // image와 제목 따로 따로 붙이기
        // jpg, png 아이콘 붙이기
        // 팝업 open, close 애니메이션
        // 팝업 시 프린트, 링크 복사 아이콘 추가하기
        // ...
        // Jallery 타이틀 만들기
        // 다른사람 레이아웃, 색상 영감 받고 적용하기

        // 랜덤 이미지 주기
        // 랜덤 색상 주기
        $(document).ready(function() {
            
            var himg = $(".himg");
            var random_num;
            for(let i = 0; i < $(".paper").length; i++) {
                random_num = 200 + Math.floor(Math.random() * 101);
                //$(himg[i]).attr("src", 
                //"http://placekitten.com/190/" + random_num.toString());

                var p_content =$(".paper-content");
                var colorR = Math.floor((Math.random() * 256));
                var colorG = Math.floor((Math.random() * 256));
                var colorB = Math.floor((Math.random() * 256));   
                $(p_content[i]).css("background-color", "rgb(" + colorR + "," + colorG + "," + colorB + ")");
            }            
        });
    </script>
</head>

<body>
    <div id="gradient" />
    <header id="main-header">

        <div class="ui-widget header-search-form">
        </div>

        <h1 class="header-title"></h1>
    </header>

    <nav id="main-navigation">
        <div class="navi-div">
        <form>
            <input type="file" class="file-submit" 
            id="file-select" webkitdirectory multiple><br>
            <input type="text" class="input-search">
            <div class="click_div">Click Here~!!</div>
        </form>
        <!-- <ul>
            <li><a href="#">Following</a></li>
            <li><a href="#">Categories</a></li>
            <li><a href="#">Everything</a></li>
            <li><a href="#">Popular</a></li>
            <li><a href="#">Gift</a></li>
        </ul> -->
        </div>
    </nav>

    <section id="main-section">
        <!-- 페이퍼 시작 -->
        <!-- <div class="paper">
            <input class="img_path" type="hidden" value="">

            <div class="paper-holder">
                <a><img class="himg" width="190" src="http://placekitten.com/190/328"></a>
            </div>
            <p class="paper-description">
                Lorem ipsum dolor sit amet
            </p>

            <div class="paper-content">
                <a class="paper-link" href="#">
                    <img src="http://placekitten.com/30/30">
                </a>
                <p class="paper-text">Lorem, ipsum dolor sit amet consectetur adipisicing elit. Rem, sequi blanditiis quod aliquid maiores dicta explicabo doloribus iste reiciendis quaerat voluptate, aspernatur sint beatae delectus tempore quo est ipsum eos!</p>
            </div>

        </div> -->
        <!-- 페이퍼 끝 -->
    </section>

    <div id="darken-background">
        <div id="leftbox"></div>
        <div id="lightbox">
            <div class="user-information">

                <a class="user-information-image" href="#">
                    <img src="http://placekitten.com/70/70">
                </a>
                
                <div class="user-information-text">
                    <h3>User</h3>
                </div>

            </div>
            
            <hr class="lightbox-splitter">

            <img id="random-image" src="http://placekitten.com/600/750">
        </div>
        <div id="rightbox"></div>
    </div>

    <footer id="main-footer">

    </footer>
</body>
</html>